<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Test</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
html{height:100%;font:3vmin monospace;background:#222;color:#eee}
body{min-height:100%;padding:1rem;display:grid;place-items:center}
main{display:flex;flex-direction:column}
a{color:inherit}
a:not([href]):after{
  content:'...';
  animation:spinner 800ms steps(5) infinite;
  font-family:monospace;
}
@keyframes spinner{
  0%{content:"..."}
  20%{content:"\00a0.."}
  40%{content:"\00a0\00a0."}
  60%{content:".\00a0\00a0"}
  80%{content:"..\00a0"}
}
</style>
</head>
<body>
<main>
  <a>Generating proof of work</a>
</main>
</body>
<script type="module">
import pow from './lib.mjs';
const link=document.querySelector('main>a');
const nonce=new Uint8Array(
  await crypto.subtle.digest('SHA-256', new TextEncoder().encode('blah'))
).subarray(0,16);
console.log(`nonce: ${nonce.toHex()}`);
link.setAttribute('download',nonce.toHex());
const t0=Date.now();
const abortController=new AbortController();
const onProgress=progress=>{
  console.log(`${progress*100}%`);
}
const proof=await pow(nonce,abortController.signal,onProgress);
const t1=Date.now();
console.log(`sha256: 0x${new Uint8Array((await crypto.subtle.digest('SHA-256',proof))).toHex()}`);
console.log(`${t1-t0}ms`);
const blob=new Blob([proof],{type: 'application/octet-stream'});
link.href=URL.createObjectURL(blob);
link.textContent=`Proof generated (${proof.length}b)`;
</script>
</html>
